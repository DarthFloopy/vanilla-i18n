"use strict";const MSG_LEVELS=["DEBUG","INFO","WARN","ERROR"],DEFAULT_i18n_DATA_ATTR="vanilla-i18n",DEFAULT_i18n_DIR="assets/vanilla-i18n",DEFAULT_LANG_TOGGLER_ID="vanilla-i18n-toggler";class Translator{constructor(t,e){this._languages=t,this._path=this._sanitizePath(e.path||DEFAULT_i18n_DIR),this._debug=e.debug||!1,this._i18nDataAttr=e.i18n_attr_name||DEFAULT_i18n_DATA_ATTR,this._localStorageKey=this._generateKeyFromHost(),this._togglerID=e.toggler_id||DEFAULT_LANG_TOGGLER_ID,!this._getLanguage()&&e.default_language&&this._setSavedLanguage(e.default_language),document.addEventListener("DOMContentLoaded",()=>{this._attachOnChangeToi18nToggler(e.toggler_id||DEFAULT_LANG_TOGGLER_ID)})}async run(){const t=this._getLanguage();if(t&&!this._languages.includes(t))return void this._printMsg(`unsupported ${t} language found in local storage, supported languages are ${this._languages}`,MSG_LEVELS[3]);if(!t)return void this._printMsg("no set language found, default language will be used",MSG_LEVELS[2]);document.addEventListener("DOMContentLoaded",()=>{this._setTogglerValue(t,this._togglerID)});const e=await this._loadLangFile(t);if(!e)return void this._printMsg(`failed to load translation file for ${t}`,MSG_LEVELS[3]);const n=this._getElementsForTranslation();n?(this._translate(n,e),this._printMsg(`translation to ${t} finished for ${n.length} elements`,MSG_LEVELS[0])):this._printMsg("no element found for translating",MSG_LEVELS[2])}_runOnChange(t){if(!this._languages.includes(t))return void this._printMsg(`${t} is not supported, supported languages are ${this._languages}`,MSG_LEVELS[3]);const e=this._getLanguage();t!=e?(this._printMsg(`switching to ${t} from ${e}`,MSG_LEVELS[1]),this._setSavedLanguage(t),this.run()):this._printMsg("selected language is same as current language",MSG_LEVELS[0])}_attachOnChangeToi18nToggler(t){const e=document.getElementById(t);e?e.addEventListener("change",t=>{this._runOnChange(t.target.value)}):this._printMsg(`no language toggler found with id "${t}" for attaching onChange event`,MSG_LEVELS[2])}_setTogglerValue(t,e){const n=document.getElementById(e);n?(n.value=t,n.dispatchEvent(new Event("change"))):this._printMsg(`no language toggler found with id "${e}" for setting value`,MSG_LEVELS[2])}_translate(t,e){e&&t.forEach(t=>{var n=t.getAttribute(this._i18nDataAttr).split(".").reduce((t,e)=>t[e],e);n&&(t.innerHTML=n)})}_getElementsForTranslation(){return document.querySelectorAll("["+this._i18nDataAttr+"]")}async _loadLangFile(t){if(!t)return;const e=`/${this._path}/${t}.json`;try{return(await fetch(e)).json()}catch{}}_getLanguage(){var t=this._getSavedLanguage();return t||this._printMsg("no saved language found, default language will load",MSG_LEVELS[0]),t}_getSavedLanguage(){return window.localStorage.getItem(this._localStorageKey)}_setSavedLanguage(t){t&&window.localStorage.setItem(this._localStorageKey,t)}_generateKeyFromHost(){return window.location.host+"-vanilla-i18n"}_sanitizePath(t){return"/"===(t=t.trim())[0]&&(t=t.slice(1,t.length)),"/"===t[t.length-1]&&(t=t.slice(0,-1)),t}_printMsg(t,e){(e!==MSG_LEVELS[0]||this._debug)&&console.info("vanilla-i18n | "+e+":"+t)}}